schema: '2.0'
stages:
  data_ingestion:
    cmd: "uv run python -m src.data.download_dataset --url https://raw.githubusercontent.com/Himanshu-1703/reddit-sentiment-analysis/refs/heads/main/data/reddit.csv\
      \  --output_path data/raw/reddit_comments.csv\n"
    deps:
    - path: src/data/download_dataset.py
      hash: md5
      md5: a45d3f80f265ba9bb030d812ee1189c4
      size: 3541
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    outs:
    - path: data/raw/reddit_comments.csv
      hash: md5
      md5: 38ee083169162dbac0cb07c80ac0f04e
      size: 6888934
  data_preparation:
    cmd: "uv run python -m src.data.make_dataset  --test_size 0.15  --random_state
      42\n"
    deps:
    - path: data/raw/reddit_comments.csv
      hash: md5
      md5: 38ee083169162dbac0cb07c80ac0f04e
      size: 6888934
    - path: src/data/make_dataset.py
      hash: md5
      md5: 1145dd23e809563e1fdc3df32ce6c02f
      size: 5553
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    params:
      params.yaml:
        data_preparation.random_state: 42
        data_preparation.test_size: 0.15
    outs:
    - path: data/processed/test.parquet
      hash: md5
      md5: 27afcf1e4e595381b70f8fd8b8e6ae7b
      size: 513629
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
  feature_comparison:
    cmd: "uv run python -m src.features.tfidf_vs_bert --ngram_ranges [(1,1),(1,2),(1,3)]
      --max_features 5000 --batch_size 32 --n_estimators 200 --max_depth 15 --use_bert
      false\n"
    deps:
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
    - path: src/features/helpers/feature_utils.py
      hash: md5
      md5: e0f9947d31fadd92c998640dda59a078
      size: 6654
    - path: src/features/tfidf_vs_bert.py
      hash: md5
      md5: 076cf6e4dde89dc3215179da7c9fc5f3
      size: 10496
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    params:
      params.yaml:
        feature_comparison.batch_size: 32
        feature_comparison.max_depth: 15
        feature_comparison.max_features: 5000
        feature_comparison.mlflow_uri: http://127.0.0.1:5000
        feature_comparison.n_estimators: 200
        feature_comparison.ngram_ranges: '[(1,1),(1,2),(1,3)]'
  feature_tuning:
    cmd: "uv run python -m src.features.tfidf_max_features  --max_features_values
      [1000,2000,3000,4000,5000,6000,7000,8000,9000,10000]  --ngram_range (1,1)  --n_estimators
      200  --max_depth 15\n"
    deps:
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
    - path: src/features/helpers/feature_utils.py
      hash: md5
      md5: e0f9947d31fadd92c998640dda59a078
      size: 6654
    - path: src/features/tfidf_max_features.py
      hash: md5
      md5: d1457c0d782aa1dda22552619e7eeca4
      size: 5847
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    params:
      params.yaml:
        feature_tuning.best_ngram_range: (1,1)
        feature_tuning.max_depth: 15
        feature_tuning.max_features_values: '[1000,2000,3000,4000,5000,6000,7000,8000,9000,10000]'
        feature_tuning.n_estimators: 200
    outs:
    - path: reports/figures/tfidf_max_features/
      hash: md5
      md5: eabf648af9fcb65173df04cb477f357d.dir
      size: 353869
      nfiles: 10
  feature_engineering:
    cmd: "uv run python -m src.features.feature_engineering  --use_bert False  --max_features
      1000  --ngram_range (1,1)  --bert_batch_size 32\n"
    deps:
    - path: data/processed/test.parquet
      hash: md5
      md5: 27afcf1e4e595381b70f8fd8b8e6ae7b
      size: 513629
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
    - path: src/features/feature_engineering.py
      hash: md5
      md5: a7ce3798f261738dfc0c52446b697c93
      size: 12447
    - path: src/features/helpers/feature_utils.py
      hash: md5
      md5: e0f9947d31fadd92c998640dda59a078
      size: 6654
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    params:
      params.yaml:
        feature_engineering.bert_batch_size: 32
        feature_engineering.use_bert: 'False'
        imbalance_tuning.best_max_features: 1000
        imbalance_tuning.best_ngram_range: (1,1)
    outs:
    - path: models/features/
      hash: md5
      md5: c06b7bafbeca9fb2488a1168dbd217cc.dir
      size: 3053483
      nfiles: 8
  baseline_model:
    cmd: uv run python -m src.models.baseline_logistic
    deps:
    - path: models/features/X_test.npz
      hash: md5
      md5: 5ad9362bddb9771a265e72d40a3e568c
      size: 411831
    - path: models/features/X_train.npz
      hash: md5
      md5: 0da3db618a4facc78e97d864e1962590
      size: 1911617
    - path: models/features/X_val.npz
      hash: md5
      md5: 262666f9552c8532a609e22fbaae5631
      size: 398166
    - path: models/features/label_encoder.pkl
      hash: md5
      md5: e4605a38643e9060a9b7203131961036
      size: 275
    - path: models/features/y_test.npy
      hash: md5
      md5: 3d93b2947650aff2973d57248ddfa80d
      size: 44320
    - path: models/features/y_train.npy
      hash: md5
      md5: ff2992f566f145e0dabff508b76fd5de
      size: 206344
    - path: models/features/y_val.npy
      hash: md5
      md5: 6170668e1d3ef3e4b157d5a76a85299e
      size: 44320
    - path: src/models/baseline_logistic.py
      hash: md5
      md5: 6b59d4b0c251bd22429b07cc5d5fdc8b
      size: 5016
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    outs:
    - path: models/baseline/logistic_baseline.pkl
      hash: md5
      md5: 044600b82899fb34284a4867eecf3c7e
      size: 25056
  train_xgboost:
    cmd: uv run python -m src.models.xgboost_training
    deps:
    - path: models/features/X_train.npz
      hash: md5
      md5: 0da3db618a4facc78e97d864e1962590
      size: 1911617
    - path: models/features/X_val.npz
      hash: md5
      md5: 262666f9552c8532a609e22fbaae5631
      size: 398166
    - path: models/features/y_train.npy
      hash: md5
      md5: ff2992f566f145e0dabff508b76fd5de
      size: 206344
    - path: models/features/y_val.npy
      hash: md5
      md5: 6170668e1d3ef3e4b157d5a76a85299e
      size: 44320
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/models/xgboost_training.py
      hash: md5
      md5: 271fe94dea82d84abedd24ecfb3f2236
      size: 4599
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    params:
      params.yaml:
        train.xgboost.n_trials: 30
    outs:
    - path: models/advanced/xgboost_metrics.json
      hash: md5
      md5: 521b4f481d20cf782e6e316a071549a1
      size: 44
    - path: models/advanced/xgboost_model.pkl
      hash: md5
      md5: 4fe3e88dd447a78f18eb078fec88d886
      size: 1088061
  imbalance_tuning:
    cmd: "uv run python -m src.features.imbalance_tuning  --imbalance_methods \"['class_weights','oversampling','adasyn','undersampling','smote_enn']\"\
      \  --max_features 1000  --ngram_range (1,1)  --n_estimators 200  --max_depth
      15\n"
    deps:
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
    - path: src/features/helpers/feature_utils.py
      hash: md5
      md5: e0f9947d31fadd92c998640dda59a078
      size: 6654
    - path: src/features/imbalance_tuning.py
      hash: md5
      md5: 8a3aa5508e5fa8e95c6bfd5169e495e1
      size: 8507
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    params:
      params.yaml:
        imbalance_tuning.best_max_features: 1000
        imbalance_tuning.best_ngram_range: (1,1)
        imbalance_tuning.imbalance_methods: "['class_weights','oversampling','adasyn','undersampling','smote_enn']"
        imbalance_tuning.rf_max_depth: 15
        imbalance_tuning.rf_n_estimators: 200
    outs:
    - path: reports/figures/imbalance_methods/
      hash: md5
      md5: 8982d1354b599b05982b5cd9930364ae.dir
      size: 167254
      nfiles: 5
  train_lightgbm:
    cmd: uv run python -m src.models.lightgbm_training
    deps:
    - path: models/features/X_train.npz
      hash: md5
      md5: 0da3db618a4facc78e97d864e1962590
      size: 1911617
    - path: models/features/X_val.npz
      hash: md5
      md5: 262666f9552c8532a609e22fbaae5631
      size: 398166
    - path: models/features/y_train.npy
      hash: md5
      md5: ff2992f566f145e0dabff508b76fd5de
      size: 206344
    - path: models/features/y_val.npy
      hash: md5
      md5: 6170668e1d3ef3e4b157d5a76a85299e
      size: 44320
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/models/lightgbm_training.py
      hash: md5
      md5: 2ff776ec0adc6542448fe822a1914671
      size: 4443
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    params:
      params.yaml:
        train.lightgbm.n_trials: 30
    outs:
    - path: models/advanced/lightgbm_metrics.json
      hash: md5
      md5: e7e5552fe55700a1771822fc512f8b1e
      size: 44
    - path: models/advanced/lightgbm_model.pkl
      hash: md5
      md5: 063a94ac7c077d4e4b8e5a35815486bf
      size: 1530346
  model_evaluation:
    cmd: uv run python -m src.models.model_evaluation
    deps:
    - path: models/advanced/lightgbm_model.pkl
      hash: md5
      md5: 7d76ba5a2f85c1c23b2fdb9b12b16446
      size: 1485657
    - path: models/features/X_test.npz
      hash: md5
      md5: 5ad9362bddb9771a265e72d40a3e568c
      size: 411831
    - path: models/features/label_encoder.pkl
      hash: md5
      md5: e4605a38643e9060a9b7203131961036
      size: 275
    - path: models/features/y_test.npy
      hash: md5
      md5: 3d93b2947650aff2973d57248ddfa80d
      size: 44320
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/models/model_evaluation.py
      hash: md5
      md5: 9d13c3627582b976f61ef4a47b128586
      size: 8506
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    - path: src/utils/paths.py
      hash: md5
      md5: c723fe5c11d3e4920067ff204eb5a6f5
      size: 1764
    outs:
    - path: models/advanced/evaluation/lightgbm_evaluation_run.json
      hash: md5
      md5: 707e388994c6c230e9b8e15975b1fdc8
      size: 96
    - path: models/advanced/evaluation/lightgbm_test_metrics.json
      hash: md5
      md5: e1c3e9bf4a6a6c0808696fdb260171bd
      size: 45
    - path: reports/figures/lightgbm_confusion_matrix.png
      hash: md5
      md5: 8cdb18e7ce8a500f78ed9c327ccc98b0
      size: 27047
    - path: reports/figures/lightgbm_roc_curve.png
      hash: md5
      md5: 1711b403d33a88445034e841490117e1
      size: 52247
    - path: reports/lightgbm_evaluation_report.md
      hash: md5
      md5: f8f0eb301955e0e7508db9b99a2ce110
      size: 619
  train_bert:
    cmd: uv run python -m src.models.bert_training
    deps:
    - path: data/processed/train.parquet
      hash: md5
      md5: ef9df44b106362663b835efdefe950c3
      size: 2394224
    - path: data/processed/val.parquet
      hash: md5
      md5: c55232be629f4fba0cdc3cce4329c594
      size: 499418
    - path: src/models/bert_training.py
      hash: md5
      md5: e532a6be3261dd58deab6829ae164b83
      size: 6155
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    - path: src/utils/paths.py
      hash: md5
      md5: 7b2d73cb9e053c99e1e0296ee965bdff
      size: 2156
    params:
      params.yaml:
        train.bert.batch_size:
        - 8
        - 16
        - 32
        train.bert.lr:
        - 1e-05
        - 5e-05
        train.bert.n_trials: 20
        train.bert.weight_decay:
        - 0.001
        - 0.1
    outs:
    - path: models/advanced/bert_metrics.json
      hash: md5
      md5: dc0d9ce7dab44784d6f81ab8636b646e
      size: 22
    - path: models/advanced/bert_model.pkl
      hash: md5
      md5: d41d8cd98f00b204e9800998ecf8427e
      size: 0
    - path: models/advanced/bert_results
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  model_registration:
    cmd: uv run python -m src.models.register_model
    deps:
    - path: models/advanced/evaluation/
      hash: md5
      md5: 6c5ca7134930758eac69c953af3f5dff.dir
      size: 30612
      nfiles: 4
    - path: src/models/register_model.py
      hash: md5
      md5: 1fe09b3da09f59ee6ace85eb2e570a1c
      size: 7347
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    - path: src/utils/paths.py
      hash: md5
      md5: c723fe5c11d3e4920067ff204eb5a6f5
      size: 1764
    params:
      params.yaml:
        register.f1_threshold: 0.75
  hyperparameter_tuning_lightgbm:
    cmd: uv run python -m src.models.hyperparameter_tuning --model lightgbm
    deps:
    - path: models/features/X_train.npz
      hash: md5
      md5: 0da3db618a4facc78e97d864e1962590
      size: 1911617
    - path: models/features/X_val.npz
      hash: md5
      md5: 262666f9552c8532a609e22fbaae5631
      size: 398166
    - path: models/features/y_train.npy
      hash: md5
      md5: ff2992f566f145e0dabff508b76fd5de
      size: 206344
    - path: models/features/y_val.npy
      hash: md5
      md5: 6170668e1d3ef3e4b157d5a76a85299e
      size: 44320
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/models/hyperparameter_tuning.py
      hash: md5
      md5: 093f54eaf35365f89661ad9ee838181e
      size: 7917
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    params:
      params.yaml:
        hyperparameter_tuning.lightgbm.n_trials: 30
    outs:
    - path: models/advanced/lightgbm_best_hyperparams.pkl
      hash: md5
      md5: bb4dab8f9b86f015fcef6eaff2a8814a
      size: 152
    - path: models/advanced/lightgbm_metrics.json
      hash: md5
      md5: d130e379875adf8586b84ad0eb4eca79
      size: 44
    - path: models/advanced/lightgbm_model.pkl
      hash: md5
      md5: 688df1ac6cf807675cc186bd27443494
      size: 1189858
  hyperparameter_tuning_xgboost:
    cmd: uv run python -m src.models.hyperparameter_tuning --model xgboost
    deps:
    - path: models/features/X_train.npz
      hash: md5
      md5: 0da3db618a4facc78e97d864e1962590
      size: 1911617
    - path: models/features/X_val.npz
      hash: md5
      md5: 262666f9552c8532a609e22fbaae5631
      size: 398166
    - path: models/features/y_train.npy
      hash: md5
      md5: ff2992f566f145e0dabff508b76fd5de
      size: 206344
    - path: models/features/y_val.npy
      hash: md5
      md5: 6170668e1d3ef3e4b157d5a76a85299e
      size: 44320
    - path: src/models/helpers/data_loader.py
      hash: md5
      md5: 7a89b90d5c30a18dd6288af65d98984e
      size: 4150
    - path: src/models/helpers/train_utils.py
      hash: md5
      md5: d13157debc27d5f22d5d7a3b3d9b80ca
      size: 4602
    - path: src/models/hyperparameter_tuning.py
      hash: md5
      md5: 093f54eaf35365f89661ad9ee838181e
      size: 7917
    - path: src/utils/logger.py
      hash: md5
      md5: 73106bb3de64f8ef8c097a990a6e2f49
      size: 2345
    - path: src/utils/mlflow_config.py
      hash: md5
      md5: 80c4e94241c5d684a2e28ce2456005eb
      size: 4882
    params:
      params.yaml:
        hyperparameter_tuning.xgboost.n_trials: 30
    outs:
    - path: models/advanced/xgboost_best_hyperparams.pkl
      hash: md5
      md5: cb607cb478d5715af954541eba7e5595
      size: 152
    - path: models/advanced/xgboost_metrics.json
      hash: md5
      md5: ad360ff41d1407ac147cf4b1fe6ede4b
      size: 44
    - path: models/advanced/xgboost_model.pkl
      hash: md5
      md5: a6d5e5828ebfe4eb13b4864c126828bb
      size: 1688490
